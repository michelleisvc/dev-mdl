<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>MDL Bookshelf</title>
  <link rel="stylesheet" href="styles.css">
</head>

<body>

  <!-- Same header as other pages -->
  <header>
  <a href="index.html">What I’m Reading → The List</a>
</header>


  <main>
    <section class="reading-section" id="bookshelf">
      <h2>Readings shaping my thinking and the books that keep me grounded</h2>
    
      <!-- Filter controls -->
      <div class="bookshelf-controls">
        <label for="genre-filter">Filter by genre:</label>
        <select id="genre-filter">
          <option value="all">All genres</option>
          <!-- JS will add more options here -->
        </select>
      </div>

      <!-- Cards go here -->
      <div id="book-grid" class="book-grid"></div>

      <p id="book-error" class="book-error" hidden>
        There was a problem loading your reading list.
      </p>
    </section>
  </main>

  <script>
    // --- Your public CSV URL ---
    const BOOKS_CSV_URL =
      "https://docs.google.com/spreadsheets/d/e/2PACX-1vSE6uzhuNaTn-QtJOl2wEoYD2p4SNWWvyYWMM_pWlM6-TuJ2crMRnw8_MqcY53ZHTMTslWroehpuk9E/pub?gid=2046680011&single=true&output=csv";

    // Basic CSV parser (works as long as cells don't have commas in them)
    function parseCSV(text) {
      return text
        .trim()
        .split("\n")
        .map(row => row.split(","));
    }

    function createCard({ title, author, genre, subGenre }) {
      const card = document.createElement("article");
      card.className = "book-card";
      card.setAttribute("data-genre", genre || "");

      card.innerHTML = `
        <header class="book-header">
          <h3 class="book-title">${title || "Untitled"}</h3>
          <p class="book-author">${author || "Unknown author"}</p>
        </header>
        <div class="book-meta">
          ${genre ? `<span class="book-pill">${genre}</span>` : ""}
          ${subGenre ? `<span class="book-pill">${subGenre}</span>` : ""}
        </div>
      `;

      return card;
    }

    function populateGenreFilter(genres) {
      const select = document.getElementById("genre-filter");
      const uniqueGenres = Array.from(new Set(genres.filter(g => g && g.trim() !== "")))
        .sort((a, b) => a.localeCompare(b));

      uniqueGenres.forEach(genre => {
        const opt = document.createElement("option");
        opt.value = genre;
        opt.textContent = genre;
        select.appendChild(opt);
      });
    }

    function applyGenreFilter() {
      const select = document.getElementById("genre-filter");
      const value = select.value;
      const cards = document.querySelectorAll(".book-card");

      cards.forEach(card => {
        const cardGenre = card.getAttribute("data-genre") || "";
        if (value === "all" || cardGenre === value) {
          card.style.display = "";
        } else {
          card.style.display = "none";
        }
      });
    }

    function loadBooks() {
      const grid = document.getElementById("book-grid");
      const errorEl = document.getElementById("book-error");

      fetch(BOOKS_CSV_URL)
        .then(res => res.text())
        .then(text => {
          const rows = parseCSV(text);
          if (!rows.length) {
            throw new Error("No data in CSV");
          }

          const headers = rows[0].map(h => h.trim().toLowerCase());
          const titleIdx = headers.indexOf("title");
          const authorIdx = headers.indexOf("author");
          const genreIdx = headers.indexOf("genre");
          const subIdx = headers.indexOf("sub-genre");

          const genresSeen = [];

          rows.slice(1).forEach(row => {
            const title = row[titleIdx] || "";
            const author = row[authorIdx] || "";
            const genre = row[genreIdx] || "";
            const subGenre = row[subIdx] || "";

            if (!title && !author) return; // skip truly empty rows

            const card = createCard({ title, author, genre, subGenre });
            grid.appendChild(card);

            if (genre) genresSeen.push(genre);
          });

          populateGenreFilter(genresSeen);

          const filterSelect = document.getElementById("genre-filter");
          filterSelect.addEventListener("change", applyGenreFilter);
        })
        .catch(err => {
          console.error("Bookshelf error:", err);
          if (errorEl) errorEl.hidden = false;
        });
    }

    document.addEventListener("DOMContentLoaded", loadBooks);
  </script>

   <footer>
    <div class="social-links">
      <a href="https://www.linkedin.com/in/michelle-dhansinghani-limón-61877015/" target="_blank" aria-label="LinkedIn">
        <!-- LinkedIn Icon -->
        <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="white" viewBox="0 0 16 16">
          <path d="M0 1.146C0 .513.526 0 1.175 0h13.65C15.474 0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 
          1.146H1.175C.526 16 0 15.487 0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401zm-1.2-8.212c.837 
          0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822 0-1.359.54-1.359 1.248 0 .694.521 
          1.248 1.327 1.248h.016zM13.458 13.394v-3.713c0-1.987-1.06-2.915-2.473-2.915-1.14 
          0-1.653.635-1.938 1.083v-0.93H6.648c.03.615 0 7.225 0 7.225h2.399v-4.034c0-.216.016-.431.079-.586.173-.431.568-.878 
          1.232-.878 0.869 0 1.217.662 1.217 1.634v3.864h2.383z"/>
        </svg>
      </a>

      <a href="https://x.com/michelleisvc" target="_blank" aria-label="X (Twitter)">
        <!-- X Icon -->
        <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="white" viewBox="0 0 24 24">
          <path d="M18.244 2h3.314l-7.227 8.26L23 22h-6.828l-5.35-7.01L4.67 22H1l7.73-8.835L1 2h6.91l4.78 
          6.42L18.244 2zm-1.16 18h1.843L7.144 4h-1.93l11.87 16z"/>
        </svg>
      </a>

      <a href="https://www.instagram.com/michelleisvc/" target="_blank" aria-label="Instagram">
        <!-- Instagram Icon -->
        <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="white" viewBox="0 0 24 24">
          <path d="M7 2C4.243 2 2 4.243 2 7v10c0 2.757 2.243 5 5 5h10c2.757 0 5-2.243 
          5-5V7c0-2.757-2.243-5-5-5H7zm10 2c1.654 0 3 1.346 3 
          3v10c0 1.654-1.346 3-3 3H7c-1.654 0-3-1.346-3-3V7c0-1.654 
          1.346-3 3-3h10zm-5 3c-2.757 0-5 2.243-5 
          5s2.243 5 5 5 5-2.243 5-5-2.243-5-5-5zm0 
          2c1.654 0 3 1.346 3 3s-1.346 3-3 
          3-3-1.346-3-3 1.346-3 3-3zm4.5-3a1.5 
          1.5 0 100 3 1.5 1.5 0 000-3z"/>
        </svg>
      </a>

      <a href="https://github.com/michelleisvc" target="_blank" aria-label="GitHub">
        <!-- GitHub Icon -->
        <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="white" viewBox="0 0 16 16">
          <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 
          2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 
          0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 
          1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 
          0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 
          0 0 .67-.21 2.2.82a7.5 7.5 0 012-.27c.68 0 1.36.09 
          2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 
          2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 
          3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 
          2.19 0 .21.15.46.55.38A8.012 8.012 0 0016 8c0-4.42-3.58-8-8-8z"/>
        </svg>
      </a>
    </div>
  </footer>


</body>
</html>
